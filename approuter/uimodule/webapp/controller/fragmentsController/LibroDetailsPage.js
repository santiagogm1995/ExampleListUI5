sap.ui.define(["test462v1s/test462v1s/controller/BaseController","test462v1s/test462v1s/utils/FactoryCall","sap/ui/model/json/JSONModel"],function(e,t,i){"use strict";return e.extend("test462v1s.test462v1s.controller.fragmentsController.LibroDetailsPage",{constructor:function(e){this.oView=e},add:async function(){this.getView().byId("key").getValue()===""?await t.getProvider("ajax").post("/api","/Libro",{Nombre:this.getView().byId("Nombre").getValue(),FechaPublicacion:new Date(this.getView().byId("FechaPublicacion").getValue()),Autor:this.getView().byId("Autor").getValue(),Paginas:Number(this.getView().byId("Paginas").getValue()),FicherofileName:this.getView().byId("Fichero").getValue(),Fichero:this.getView().byId("FicheroValue").getValue().split(",")[1]}):await t.getProvider("ajax").put("/api","/Libro/",this.getView().byId("key").getValue(),{Nombre:this.getView().byId("Nombre").getValue(),FechaPublicacion:new Date(this.getView().byId("FechaPublicacion").getValue()),Autor:this.getView().byId("Autor").getValue(),Paginas:Number(this.getView().byId("Paginas").getValue()),FicherofileName:this.getView().byId("Fichero").getValue(),Fichero:this.getView().byId("FicheroValue").getValue().split(",")[1]});let e=await t.getProvider("ajax").getAll("/api","/Libros");this.setModel(new i({LibroCollection:e}),"LibroList");this.oView.byId("key").setValue(e.id);this.oView.byId("Nombre").setValue("");this.oView.byId("FechaPublicacion").setValue("");this.oView.byId("Autor").setValue("");this.oView.byId("Paginas").setValue("");this.oView.byId("Fichero").setValue("");this.oView.byId("FicheroValue").setValue("");this.oView.byId("BotonAceptar").setText("Create");this.close()},onChangeFichero:function(e){var t=new FileReader;var i=e.getParameter("files")[0];var a=new Blob([i],{type:"text/plain"});this.getView().byId("Dialog").setBusy(true);t.onload=e=>{this.getView().byId("FicheroValue").setValue(e.target.result);this.getView().byId("Dialog").setBusy(false)};t.readAsDataURL(a)},open:async function(e){if(!this.oView.byId("Dialog")){let e=sap.ui.xmlfragment(this.oView.getId(),"test462v1s.test462v1s.view.fragments.LibroDetailsPage",this);this.oView.addDependent(e);e.open()}else{this.byId("Dialog").open()}if(e){let e=null;this.getView().byId("Dialog").setBusy(true);this.getView().byId("LibroList").getSelectedItems().forEach(t=>e=t.mAggregations.cells[0].getText());let i=await t.getProvider("ajax").get("/api","/Libro",`/${e}`);this.oView.byId("key").setValue(i.id);this.oView.byId("Nombre").setValue(i.Nombre);this.oView.byId("FechaPublicacion").setValue(i.FechaPublicacion);this.oView.byId("Autor").setValue(i.Autor);this.oView.byId("Paginas").setValue(i.Paginas);this.oView.byId("Fichero").setValue(i.FicherofileName);this.oView.byId("FicheroValue").setValue(i.Fichero);this.oView.byId("BotonAceptar").setText("Update");this.getView().byId("Dialog").setBusy(false)}},close:function(){this.getView().byId("Dialog").close()}})});