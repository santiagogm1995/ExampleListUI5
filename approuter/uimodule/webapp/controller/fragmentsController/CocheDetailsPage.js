sap.ui.define(["test462v1s/test462v1s/controller/BaseController","test462v1s/test462v1s/utils/FactoryCall","sap/ui/model/json/JSONModel"],function(e,t,i){"use strict";return e.extend("test462v1s.test462v1s.controller.fragmentsController.CocheDetailsPage",{constructor:function(e){this.oView=e},add:async function(){this.getView().byId("key").getValue()===""?await t.getProvider("ajax").post("/api","/Coche",{Modelo:this.getView().byId("Modelo").getValue(),Litros:this.getView().byId("Litros").getValue()==""?"0.00":this.getView().byId("Litros").getValue(),ImagenfileName:this.getView().byId("Imagen").getValue(),Imagen:this.getView().byId("ImagenValue").getValue().split(",")[1]}):await t.getProvider("ajax").put("/api","/Coche/",this.getView().byId("key").getValue(),{Modelo:this.getView().byId("Modelo").getValue(),Litros:this.getView().byId("Litros").getValue()==""?"0.00":this.getView().byId("Litros").getValue(),ImagenfileName:this.getView().byId("Imagen").getValue(),Imagen:this.getView().byId("ImagenValue").getValue().split(",")[1]});let e=await t.getProvider("ajax").getAll("/api","/Coches");this.setModel(new i({CocheCollection:e}),"CocheList");this.oView.byId("key").setValue(e.id);this.oView.byId("Modelo").setValue("");this.oView.byId("Litros").setValue("");this.oView.byId("Imagen").setValue("");this.oView.byId("ImagenValue").setValue("");this.oView.byId("BotonAceptar").setText("Create");this.close()},onChangeImagen:function(e){var t=new FileReader;var i=e.getParameter("files")[0];var s=new Blob([i],{type:"text/plain"});this.getView().byId("Dialog").setBusy(true);t.onload=e=>{this.getView().byId("ImagenValue").setValue(e.target.result);this.getView().byId("Dialog").setBusy(false)};t.readAsDataURL(s)},open:async function(e){if(!this.oView.byId("Dialog")){let e=sap.ui.xmlfragment(this.oView.getId(),"test462v1s.test462v1s.view.fragments.CocheDetailsPage",this);this.oView.addDependent(e);e.open()}else{this.byId("Dialog").open()}if(e){let e=null;this.getView().byId("Dialog").setBusy(true);this.getView().byId("CocheList").getSelectedItems().forEach(t=>e=t.mAggregations.cells[0].getText());let i=await t.getProvider("ajax").get("/api","/Coche",`/${e}`);this.oView.byId("key").setValue(i.id);this.oView.byId("Modelo").setValue(i.Modelo);this.oView.byId("Litros").setValue(i.Litros);this.oView.byId("Imagen").setValue(i.ImagenfileName);this.oView.byId("ImagenValue").setValue(i.Imagen);this.oView.byId("BotonAceptar").setText("Update");this.getView().byId("Dialog").setBusy(false)}},close:function(){this.getView().byId("Dialog").close()}})});